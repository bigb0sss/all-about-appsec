<!DOCTYPE html>
<html>
    <head>
        <title>Challenge 01<title/>
    <head/>
    <body>
        <h1>Challenge 01</h1>>
        <script>
            function onRecieve(message) {
                document.write(message.data);
            }
            window.addEventListener('message', onReceive, true);
        </script>
    </body>
<html/>

<!--
# Link
https://twitter.com/SonarSource/status/1466074614346534916/photo/1

# Issues
DOM XSS. "addEventListener" handler for message event is registered and writes the event's data in the DOM

# Mitigation
- Implement message.origin validation
- Encode/sanitize the message.data before document.write
-->